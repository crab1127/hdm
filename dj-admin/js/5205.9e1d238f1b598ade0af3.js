(self.webpackChunkxiaoniao=self.webpackChunkxiaoniao||[]).push([[5205],{70113:(e,t,a)=>{"use strict";a.d(t,{Z:()=>Z});var n=a(24595),l=a(80346),i=a(15851),r=a(92238),s=a(34846),c=a(16255),o=a.n(c),d=a(81420),u=a(44842),m=i.forwardRef((function(e,t){var a,n=e.prefixCls,c=void 0===n?"rc-switch":n,m=e.className,f=e.checked,p=e.defaultChecked,v=e.disabled,g=e.loadingIcon,h=e.checkedChildren,b=e.unCheckedChildren,E=e.onClick,Z=e.onChange,k=e.onKeyDown,O=(0,s.Z)(e,["prefixCls","className","checked","defaultChecked","disabled","loadingIcon","checkedChildren","unCheckedChildren","onClick","onChange","onKeyDown"]),C=(0,d.Z)(!1,{value:f,defaultValue:p}),y=(0,r.Z)(C,2),j=y[0],I=y[1];function x(e,t){var a=j;return v||(I(a=e),null==Z||Z(a,t)),a}var w=o()(c,m,(a={},(0,l.Z)(a,"".concat(c,"-checked"),j),(0,l.Z)(a,"".concat(c,"-disabled"),v),a));return i.createElement("button",Object.assign({},O,{type:"button",role:"switch","aria-checked":j,disabled:v,className:w,ref:t,onKeyDown:function(e){e.which===u.Z.LEFT?x(!1,e):e.which===u.Z.RIGHT&&x(!0,e),null==k||k(e)},onClick:function(e){var t=x(!j,e);null==E||E(t,e)}}),g,i.createElement("span",{className:"".concat(c,"-inner")},j?h:b))}));m.displayName="Switch";const f=m;var p=a(89738),v=a(26420),g=a(42795),h=a(17979),b=a(83493),E=i.forwardRef((function(e,t){var a,r=e.prefixCls,s=e.size,c=e.loading,d=e.className,u=void 0===d?"":d,m=e.disabled,E=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var l=0;for(n=Object.getOwnPropertySymbols(e);l<n.length;l++)t.indexOf(n[l])<0&&Object.prototype.propertyIsEnumerable.call(e,n[l])&&(a[n[l]]=e[n[l]])}return a}(e,["prefixCls","size","loading","className","disabled"]);(0,b.Z)("checked"in E||!("value"in E),"Switch","`value` is not a valid prop, do you mean `checked`?");var Z=i.useContext(g.E_),k=Z.getPrefixCls,O=Z.direction,C=i.useContext(h.Z),y=k("switch",r),j=i.createElement("div",{className:"".concat(y,"-handle")},c&&i.createElement(p.Z,{className:"".concat(y,"-loading-icon")})),I=o()((a={},(0,l.Z)(a,"".concat(y,"-small"),"small"===(s||C)),(0,l.Z)(a,"".concat(y,"-loading"),c),(0,l.Z)(a,"".concat(y,"-rtl"),"rtl"===O),a),u);return i.createElement(v.Z,{insertExtraNode:!0},i.createElement(f,(0,n.Z)({},E,{prefixCls:y,className:I,disabled:m||c,ref:t,loadingIcon:j})))}));E.__ANT_SWITCH=!0,E.displayName="Switch";const Z=E},22854:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>i});var n=a(45154),l=a.n(n)()((function(e){return e[1]}));l.push([e.id,"/** @format */\n.toolsBar {\n  background: #fff;\n  padding: 10px;\n}\n.toolsBar .toolsBar-content {\n  padding: 10px;\n  background: #f4f4f4;\n  margin-top: 5px;\n}\n",""]);const i=l},4892:(e,t,a)=>{"use strict";var n=a(57574),l=a.n(n),i=a(22854),r=l()(i.default,{insert:"head",singleton:!1});if(!i.default.locals||e.hot.invalidate){var s=i.default.locals;e.hot.accept(22854,(t=>{i=a(22854),function(e,t,a){if(!e&&t||e&&!t)return!1;var n;for(n in e)if(e[n]!==t[n])return!1;for(n in t)if(!e[n])return!1;return!0}(s,i.default.locals)?(s=i.default.locals,r(i.default)):e.hot.invalidate()}))}e.hot.dispose((function(){r()})),i.default.locals},21685:(e,t,a)=>{"use strict";a.d(t,{Z:()=>i});var n=a(15851),l=a(53922);const i=e=>{const{permsList:t}=l.Z.useContainer();return t.includes(e.name)?n.createElement(n.Fragment,null," ",e.children," "):n.createElement(n.Fragment,null)}},381:(e,t,a)=>{"use strict";a.d(t,{Z:()=>i});var n=a(15851);a(4892);const l=({visible:e,content:t,children:a})=>n.createElement("div",{className:"toolsBar"},n.createElement("div",{className:"flex flex_between"},a),n.createElement("div",{style:{display:e?"block":"none"},className:"toolsBar-content"},t));l.defaultProps={visible:!1};const i=l},25715:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});var n=a(43865),l=a(58233),i=a(15851);const r=function(e,t){var a;const{form:r}=t,s=(0,n._T)(t,["form"]),c=(0,l.ZP)(e,Object.assign(Object.assign({},s),{paginated:!0,manual:!0})),{params:o,run:d,mutate:u}=c,m=o[2]||{},[f,p]=(0,i.useState)(m.type||"simple"),[v,g]=(0,i.useState)(m.allFormData||{}),h=(0,i.useCallback)((()=>{if(r.getFieldInstance){const e=r.getFieldsValue(),t={};return Object.keys(e).forEach((a=>{r.getFieldInstance&&!r.getFieldInstance(a)||(t[a]=e[a])})),t}return r.getFieldsValue(null,(()=>!0))}),[r]);(0,i.useEffect)((()=>{if(r.getFieldInstance){const e={};Object.keys(v).forEach((t=>{r.getFieldInstance&&!r.getFieldInstance(t)||(e[t]=v[t])})),r.setFieldsValue(e)}else r.setFieldsValue(v)}),[f]),(0,i.useEffect)((()=>{o.length>0?d(...o):t.manual||E()}),[]);const b=(0,i.useCallback)((()=>{const e=h();g(Object.assign(Object.assign({},v),e)),p("simple"===f?"advance":"simple")}),[f,v,h]),E=(0,i.useCallback)((e=>{(null==e?void 0:e.preventDefault)&&e.preventDefault(),setTimeout((()=>{const e=h();console.log(1111,e);const a=Object.assign(Object.assign({},v),e);g(a),d(Object.assign(Object.assign({},o[0]||{}),{pageSize:t.defaultPageSize||10,current:1}),e,{allFormData:a,type:f})}))}),[h,d,o,v,f]),Z=(0,i.useCallback)((()=>{r.resetFields(),E()}),[r,E]);return Object.assign(Object.assign({},c),{search:{submit:E,type:f,changeType:b,reset:Z},remove:e=>{u((t=>{const a=t.list.slice();return a.forEach(((t,n)=>{t.id===e&&a.splice(n,1)})),Object.assign(Object.assign({},t),{list:a})}))},add:e=>{u((t=>{const a=t.list.slice();return a.push(e),Object.assign(Object.assign({},t),{list:a})}))},update:(e,t)=>{u((a=>{const n=a.list.slice();return n.forEach(((a,l)=>{a.id===e&&(n[l]=Object.assign(Object.assign({},a),t))})),Object.assign(Object.assign({},a),{list:n})}))},dataSource:(null===(a=c.data)||void 0===a?void 0:a.list)||[]})}},14736:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>g});var n=a(43865),l=a(15851),i=a(36949),r=a(53985),s=a(72390),c=a(21921),o=a(49222),d=a(83e3),u=a(41915),m=a(57100),f=a(79096);const p={labelCol:{span:4},wrapperCol:{span:20}},v=e=>{var t,{data:a}=e,v=(0,n._T)(e,["data"]);const[g]=i.Z.useForm(),h=(0,m.QT)((()=>(0,u.UI)({cache:1}).then((e=>e.data)))),b=(0,m.QT)((()=>(0,u.ms)({cache:1}).then((e=>(0,f.a2)(e.data.map((e=>({pid:e.pid,title:e.name,value:e.id}))),0,{id:"value",pid:"pid",children:"children"})))));return(0,l.useEffect)((()=>{v.visible&&setTimeout((()=>{a?g.setFieldsValue(Object.assign({},a)):(g.resetFields(),g.setFieldsValue({status:1,sort:1}))}))}),[v.visible]),l.createElement(r.Z,{title:(null==a?void 0:a.id)?"编辑":"添加",maskClosable:!1,visible:v.visible,onCancel:()=>v.onClose(),onOk:e=>{e.preventDefault(),g.validateFields().then((e=>(0,n.mG)(void 0,void 0,void 0,(function*(){var t;const n=Object.assign(Object.assign({},a),e);(null==a?void 0:a.id)?yield(0,u.Nq)(a.id,e):yield(0,u.r4)(e),v.onClose(),null===(t=v.onOk)||void 0===t||t.call(v,(null==a?void 0:a.id)?"update":"create",n)}))))}},l.createElement(i.Z,Object.assign({form:g},p),l.createElement(i.Z.Item,{label:"名称",name:"name",rules:[{required:!0}]},l.createElement(s.Z,{maxLength:10})),l.createElement(i.Z.Item,{label:"编码",name:"code",rules:[{required:!0}]},l.createElement(s.Z,{maxLength:8})),l.createElement(i.Z.Item,{label:"电话",name:"mobile",rules:[{required:!0}]},l.createElement(s.Z,{maxLength:11})),l.createElement(i.Z.Item,{label:"岗位",name:"post_id"},l.createElement(c.Z,null,null===(t=h.data)||void 0===t?void 0:t.map((e=>l.createElement(c.Z.Option,{key:e.id,value:e.id},e.name))))),l.createElement(i.Z.Item,{label:"部门",name:"org_id"},l.createElement(o.Z,{style:{width:"100%"},allowClear:!0,dropdownStyle:{maxHeight:400,overflow:"auto"},treeData:b.data,placeholder:"请选择部门"})),l.createElement(i.Z.Item,{label:"性别",name:"gender"},l.createElement(d.ZP.Group,null,l.createElement(d.ZP,{value:0},"男"),l.createElement(d.ZP,{value:1},"女"))),l.createElement(i.Z.Item,{label:"状态",name:"status"},l.createElement(d.ZP.Group,null,l.createElement(d.ZP,{value:1},"启用"),l.createElement(d.ZP,{value:0},"禁用")))))};v.defaultProps={disabled:[]};const g=v},5205:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>y});var n=a(15851),l=a(73630),i=a(36949),r=a(53985),s=a(49293),c=a(70113),o=a(25192),d=a(72145),u=a(72390),m=a(21921),f=a(80471),p=a(25715),v=a(14736),g=a(381),h=a(41915),b=a(80900),E=a.n(b),Z=a(57100),k=a(79096),O=a(21685),C=a(74848);const y=()=>{const e=(0,l.$B)(),t=(0,Z.kt)(!1),[a,b]=(0,n.useState)(),[y]=i.Z.useForm(),j=(0,Z.QT)((()=>(0,h.UI)({cache:1}).then((e=>e.data)))),I=(0,Z.QT)((()=>(0,h.ms)({cache:1}).then((e=>e.data)))),{tableProps:x,search:w,refresh:F,update:S,add:N,remove:_}=(0,p.Z)(((e,t)=>(0,h.lE)(Object.assign(Object.assign(Object.assign({},e),t),{usable:1})).then((e=>({total:e.total,list:e.data})))),{defaultPageSize:20,form:y}),{submit:P}=w||{},D=[{title:"员工号",dataIndex:"code"},{title:"头像",key:"avatarUrl",render:(e,t)=>n.createElement(s.C,{src:(0,k.Pk)(t.avatarUrl),alt:t.name},t.name)},{title:"用户名",dataIndex:"name"},{title:"微信昵称",dataIndex:"nickName"},{title:"手机号码",dataIndex:"mobile"},{title:"性别",key:"gender",render:(e,t)=>0===t.gender?"男":1===t.gender?"女":"未知"},{title:"部门",key:"org_id",render:(e,t)=>{var a,n;return null===(n=null===(a=I.data)||void 0===a?void 0:a.find((e=>e.id===t.org_id)))||void 0===n?void 0:n.name}},{title:"岗位",key:"post_id",render:(e,t)=>{var a,n;return null===(n=null===(a=j.data)||void 0===a?void 0:a.find((e=>e.id===t.post_id)))||void 0===n?void 0:n.name}},{title:"状态",key:"status",render:(e,t)=>n.createElement(c.Z,{checked:!!t.status,onChange:e=>{(0,h.Nq)(t.id,{status:e?1:0}),S(t.id,{status:e?1:0})}})},{title:"跟新时间",key:"update_time",render:e=>E()(e.update_time).format("YYYY-MM-DD hh:mm")},{title:"跟新人",dataIndex:"update_by"},{title:"操作",key:"action",render:e=>n.createElement(o.Z,null,n.createElement(O.Z,{name:C.g3.USER_EDIT},n.createElement(d.Z,{onClick:()=>(b(e),void t.toggle()),type:"link"},"修改")),n.createElement(O.Z,{name:C.g3.USER_REMOVE},n.createElement(d.Z,{onClick:()=>{return t=e,void r.Z.confirm({title:"提示",content:"是否真的要删除？",onOk:()=>{(0,h.kX)(t.id),_(t.id)}});var t},type:"link"},"删除")))}];return n.createElement("div",null,n.createElement(g.Z,{visible:!1},n.createElement(i.Z,{form:y,layout:"inline"},n.createElement(i.Z.Item,{name:"name"},n.createElement(u.Z.Search,{placeholder:"名字",onSearch:P})),n.createElement(i.Z.Item,{name:"mobile"},n.createElement(u.Z.Search,{placeholder:"手机号",onSearch:P})),n.createElement(i.Z.Item,{name:"status"},n.createElement(m.Z,{placeholder:"用户状态",style:{width:"140px"},allowClear:!0,onChange:P},n.createElement(m.Z.Option,{value:"0"},"暂停"),n.createElement(m.Z.Option,{value:"1"},"启用")))),n.createElement(o.Z,null,n.createElement(O.Z,{name:C.g3.USER_ADD},n.createElement(d.Z,{type:"primary",onClick:()=>{b(void 0),t.toggle()}},"新增")),n.createElement(d.Z,{onClick:F},"刷新"))),n.createElement(f.Z,Object.assign({columns:D,rowKey:"id"},x)),n.createElement(v.default,{id:parseInt(e.params.id),visible:t.state,data:a,onClose:t.setFalse,onOk:(e,t)=>{console.log(t),"update"===e?S(t.id,t):N(t)}}))}}}]);