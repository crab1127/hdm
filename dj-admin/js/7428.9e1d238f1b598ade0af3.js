(self.webpackChunkxiaoniao=self.webpackChunkxiaoniao||[]).push([[7428],{22854:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>s});var l=a(45154),n=a.n(l)()((function(e){return e[1]}));n.push([e.id,"/** @format */\n.toolsBar {\n  background: #fff;\n  padding: 10px;\n}\n.toolsBar .toolsBar-content {\n  padding: 10px;\n  background: #f4f4f4;\n  margin-top: 5px;\n}\n",""]);const s=n},4892:(e,t,a)=>{"use strict";var l=a(57574),n=a.n(l),s=a(22854),i=n()(s.default,{insert:"head",singleton:!1});if(!s.default.locals||e.hot.invalidate){var r=s.default.locals;e.hot.accept(22854,(t=>{s=a(22854),function(e,t,a){if(!e&&t||e&&!t)return!1;var l;for(l in e)if(e[l]!==t[l])return!1;for(l in t)if(!e[l])return!1;return!0}(r,s.default.locals)?(r=s.default.locals,i(s.default)):e.hot.invalidate()}))}e.hot.dispose((function(){i()})),s.default.locals},21685:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});var l=a(15851),n=a(53922);const s=e=>{const{permsList:t}=n.Z.useContainer();return t.includes(e.name)?l.createElement(l.Fragment,null," ",e.children," "):l.createElement(l.Fragment,null)}},381:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});var l=a(15851);a(4892);const n=({visible:e,content:t,children:a})=>l.createElement("div",{className:"toolsBar"},l.createElement("div",{className:"flex flex_between"},a),l.createElement("div",{style:{display:e?"block":"none"},className:"toolsBar-content"},t));n.defaultProps={visible:!1};const s=n},97482:(e,t,a)=>{"use strict";a.d(t,{Z:()=>d});var l=a(15851),n=a(27736),s=a(80337),i=a(89738),r=a(62342),c=a(79096);function o(e){const t="image/jpeg"===e.type||"image/png"===e.type;t||n.ZP.error("You can only upload JPG/PNG file!");const a=e.size/1024/1024<2;return a||n.ZP.error("Image must smaller than 2MB!"),t&&a}const d=e=>{const[t,a]=(0,l.useState)(!1),[n,d]=(0,l.useState)("");(0,l.useEffect)((()=>{d(e.value?(0,c.Pk)(e.value):"")}),[e.value]);const u=l.createElement("div",null,t?l.createElement(i.Z,null):l.createElement(r.Z,null),l.createElement("div",{className:"ant-upload-text"},"Upload"));return l.createElement(s.Z,{name:"file",listType:"picture-card",className:"avatar-uploader",showUploadList:!1,action:"https://api.harsonserver.com/clerk/common/qnUploadFile.json?platform=36",beforeUpload:o,onChange:t=>{var l;"uploading"!==t.file.status?"done"===t.file.status&&(null===(l=e.onChange)||void 0===l||l.call(e,t.fileList[0].response.data.replace("https://","")),function(e,t){const l=new FileReader;l.addEventListener("load",(()=>(e=>{a(!1),d(e)})(l.result))),l.readAsDataURL(e)}(t.file.originFileObj)):a(!0)}},n?l.createElement("img",{src:n,alt:"avatar",style:{width:"100%"}}):u)}},25715:(e,t,a)=>{"use strict";a.d(t,{Z:()=>i});var l=a(43865),n=a(58233),s=a(15851);const i=function(e,t){var a;const{form:i}=t,r=(0,l._T)(t,["form"]),c=(0,n.ZP)(e,Object.assign(Object.assign({},r),{paginated:!0,manual:!0})),{params:o,run:d,mutate:u}=c,m=o[2]||{},[p,E]=(0,s.useState)(m.type||"simple"),[f,v]=(0,s.useState)(m.allFormData||{}),b=(0,s.useCallback)((()=>{if(i.getFieldInstance){const e=i.getFieldsValue(),t={};return Object.keys(e).forEach((a=>{i.getFieldInstance&&!i.getFieldInstance(a)||(t[a]=e[a])})),t}return i.getFieldsValue(null,(()=>!0))}),[i]);(0,s.useEffect)((()=>{if(i.getFieldInstance){const e={};Object.keys(f).forEach((t=>{i.getFieldInstance&&!i.getFieldInstance(t)||(e[t]=f[t])})),i.setFieldsValue(e)}else i.setFieldsValue(f)}),[p]),(0,s.useEffect)((()=>{o.length>0?d(...o):t.manual||Z()}),[]);const g=(0,s.useCallback)((()=>{const e=b();v(Object.assign(Object.assign({},f),e)),E("simple"===p?"advance":"simple")}),[p,f,b]),Z=(0,s.useCallback)((e=>{(null==e?void 0:e.preventDefault)&&e.preventDefault(),setTimeout((()=>{const e=b();console.log(1111,e);const a=Object.assign(Object.assign({},f),e);v(a),d(Object.assign(Object.assign({},o[0]||{}),{pageSize:t.defaultPageSize||10,current:1}),e,{allFormData:a,type:p})}))}),[b,d,o,f,p]),h=(0,s.useCallback)((()=>{i.resetFields(),Z()}),[i,Z]);return Object.assign(Object.assign({},c),{search:{submit:Z,type:p,changeType:g,reset:h},remove:e=>{u((t=>{const a=t.list.slice();return a.forEach(((t,l)=>{t.id===e&&a.splice(l,1)})),Object.assign(Object.assign({},t),{list:a})}))},add:e=>{u((t=>{const a=t.list.slice();return a.push(e),Object.assign(Object.assign({},t),{list:a})}))},update:(e,t)=>{u((a=>{const l=a.list.slice();return l.forEach(((a,n)=>{a.id===e&&(l[n]=Object.assign(Object.assign({},a),t))})),Object.assign(Object.assign({},a),{list:l})}))},dataSource:(null===(a=c.data)||void 0===a?void 0:a.list)||[]})}},95577:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>v});var l=a(43865),n=a(15851),s=a(36949),i=a(53985),r=a(49222),c=a(72390),o=a(83e3),d=a(41915),u=a(97482),m=a(57100),p=a(79096);const E={labelCol:{span:4},wrapperCol:{span:20}},f=e=>{var{data:t}=e,a=(0,l._T)(e,["data"]);const[f]=s.Z.useForm(),{data:v,run:b}=(0,m.QT)((()=>(0,d.zP)(a.type).then((e=>(0,p.a2)(e.data.map((e=>({pid:e.parent_id,title:e.label,value:e.value}))),"0",{id:"value",pid:"pid",children:"children"})))),{manual:!0});return(0,n.useEffect)((()=>{a.isTree&&a.type&&b()}),[a.isTree,a.type]),(0,n.useEffect)((()=>{a.visible&&setTimeout((()=>{t?f.setFieldsValue(Object.assign({},t)):(f.resetFields(),f.setFieldsValue({status:1,sort:1,parent_id:a.parentId}))}))}),[a.visible,t,v]),n.createElement(i.Z,{title:"编辑字典",visible:a.visible,maskClosable:!1,onCancel:()=>{a.setVisible(!1)},onOk:e=>{e.preventDefault(),f.validateFields().then((e=>(0,l.mG)(void 0,void 0,void 0,(function*(){var l;const n=Object.assign(Object.assign({},t),e);if(null==t?void 0:t.id)yield(0,d.rD)(a.type,t.id,e);else{const t=yield(0,d.nF)(a.type,e);n.id=t.data,n.create_time=new Date}a.setVisible(!1),null===(l=a.onOK)||void 0===l||l.call(a,(null==t?void 0:t.id)?"update":"create",n)}))))}},n.createElement(s.Z,Object.assign({},E,{form:f}),a.isTree&&n.createElement(s.Z.Item,{label:"上级菜单",name:"parent_id"},n.createElement(r.Z,{style:{width:"100%"},allowClear:!0,dropdownStyle:{maxHeight:400,overflow:"auto"},treeData:v,placeholder:"请选择父级,不选默认最顶层"})),n.createElement(s.Z.Item,{name:"label",label:"名称",rules:[{required:!0,message:"Please input your E-mail!"}]},n.createElement(c.Z,null)),n.createElement(s.Z.Item,{label:"值",name:"value",rules:[{required:!0,message:"Please input your E-mail!"}]},n.createElement(c.Z,null)),n.createElement(s.Z.Item,{label:"logo",name:"logo",getValueFromEvent:e=>e},n.createElement(u.Z,null)),n.createElement(s.Z.Item,{label:"状态",name:"status"},n.createElement(o.ZP.Group,null,n.createElement(o.ZP,{value:1},"启用"),n.createElement(o.ZP,{value:0},"禁用"))),n.createElement(s.Z.Item,{label:"备注",name:"remark",required:!0},n.createElement(c.Z,null))))};f.defaultProps={visible:!1,isTree:!1,parentId:"0"};const v=f},40803:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>m});var l=a(43865),n=a(15851),s=a(36949),i=a(53985),r=a(72390),c=a(83e3),o=a(41915);const d={labelCol:{span:4},wrapperCol:{span:20}},u=e=>{var{data:t}=e,a=(0,l._T)(e,["data"]);const[u]=s.Z.useForm();return(0,n.useEffect)((()=>{a.visible&&u.setFieldsValue(t)}),[a.visible]),n.createElement(i.Z,{title:(null==t?void 0:t.id)?"编辑字典分类":"添加字典分类",visible:a.visible,onCancel:()=>{a.setVisible(!1)},onOk:e=>{e.preventDefault(),u.validateFields().then((e=>(0,l.mG)(void 0,void 0,void 0,(function*(){const l=Object.assign({},e);if(null==t?void 0:t.id)yield(0,o.Cz)(t.id,e),l.id=t.id,a.updateData((e=>{const t=e.slice();return t.forEach((e=>{e.id===l.id&&Object.assign(e,l)})),t}));else{const t=yield(0,o.XH)(e);l.id=t.data,l.create_time=new Date,a.updateData((e=>{const t=e.slice();return t.push(l),t}))}a.setVisible(!1),a.onOk&&a.onOk(l)}))))}},a.visible&&n.createElement(s.Z,Object.assign({form:u},d),n.createElement(s.Z.Item,{label:"名称",name:"name",required:!0},n.createElement(r.Z,null)),n.createElement(s.Z.Item,{label:"code",name:"code",required:!0},n.createElement(r.Z,null)),n.createElement(s.Z.Item,{label:"状态",name:"status",required:!0},n.createElement(c.ZP.Group,null,n.createElement(c.ZP,{value:1},"启用"),n.createElement(c.ZP,{value:0},"禁用"))),n.createElement(s.Z.Item,{label:"是否树形",name:"is_tree"},n.createElement(c.ZP.Group,null,n.createElement(c.ZP,{value:0},"否"),n.createElement(c.ZP,{value:1},"是"))),n.createElement(s.Z.Item,{label:"备注",name:"remark"},n.createElement(r.Z.TextArea,{rows:3}))))};u.defaultProps={data:{id:NaN,name:"",code:"",status:1,is_tree:0,remark:""}};const m=u},47428:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>C});var l=a(43865),n=a(15851),s=a(36949),i=a(70113),r=a(72145),c=a(1938),o=a(30511),d=a(72390),u=a(21921),m=a(80471),p=a(25715),E=a(95577),f=a(40803),v=a(381),b=a(41915),g=a(80900),Z=a.n(g),h=a(42080),y=a(79096),k=a(74848),O=a(21685);const C=()=>{const[e,t]=(0,n.useState)(!1),[a,g]=(0,n.useState)(!1),[C,j]=(0,n.useState)(),[I,F]=(0,n.useState)([]),[P,S]=(0,n.useState)("0"),[D,T]=(0,n.useState)(),[_,w]=(0,n.useState)(""),[x]=s.Z.useForm();(0,n.useEffect)((()=>{(0,b.Vw)().then((e=>{F(e.data),T(e.data[0]),w(e.data[0].code)}))}),[]),(0,n.useEffect)((()=>{console.log("activeCategoryCode: ",_),_&&setTimeout((()=>{Y()}))}),[_]);const{tableProps:V,search:G,refresh:Y,add:M,update:N,remove:q}=(0,p.Z)(((e,t)=>_?(0,b.zP)(_,Object.assign(Object.assign({},e),t)).then((e=>(null==D?void 0:D.is_tree)?{list:(0,y.a2)(e.data,"0",{id:"value",pid:"parent_id",children:"children"}),total:0}:{total:e.data.length,list:e.data})):Promise.resolve({total:0,list:[]})),{defaultPageSize:20,form:x,cacheKey:"tableProps"}),{submit:z}=G||{},B=(e="0")=>{S(e),j(void 0),g(!0)},R=[{title:"名称",dataIndex:"label"},{title:"值",dataIndex:"value"},{title:"logo",key:"logo",render:(e,t)=>t.logo?n.createElement("img",{src:"//"+t.logo,width:"30"}):""},{title:"状态",key:"status",render:e=>n.createElement(i.Z,{checked:!!e.status,onChange:t=>((e,t)=>{N(t.id,Object.assign(Object.assign({},t),{status:e?1:0})),(0,b.rD)(_,t.id,{status:e?1:0})})(t,e)})},{title:"备注",dataIndex:"remark"},{title:"创建时间",key:"create_time",render:e=>n.createElement("span",null," ",Z()(e.create_time).format("YYYY-MM-DD"))},{title:"操作",key:"action",render:e=>n.createElement("div",null,n.createElement(O.Z,{name:k.g3.SYSTEM_DICT_EDIT},n.createElement(r.Z,{onClick:()=>(j(e),void g(!0)),type:"link"},"修改")),n.createElement(O.Z,{name:k.g3.SYSTEM_DICT_ADD},n.createElement(r.Z,{onClick:()=>B(e.value),type:"link"},"新增")),n.createElement(O.Z,{name:k.g3.SYSTEM_DICT_REMOVE},n.createElement(r.Z,{onClick:()=>(e=>(0,l.mG)(void 0,void 0,void 0,(function*(){yield(0,b.OJ)(_,e.id),q(e.id)})))(e),type:"link"},"删除")))}];return n.createElement("div",null,n.createElement(c.Z,null,n.createElement(c.Z.Sider,{width:200,style:{background:"#fff",borderRight:"1px solid #ddd"}},n.createElement("div",{style:{padding:"10px",display:"flex",alignItems:"center",justifyContent:"center"}},n.createElement(r.Z.Group,null,n.createElement(r.Z,{type:"primary",onClick:()=>{T(void 0),t(!0)}},"新增1"),n.createElement(r.Z,{type:"primary",onClick:()=>{T(I.find((e=>e.code===_))),t(!0)}},"修改"))),n.createElement(h.Z,null,n.createElement(o.Z,{mode:"inline",selectedKeys:[_],onClick:({key:e})=>{w(e),T(I.find((t=>t.code===e)))},style:{borderRight:0}},I.map((e=>n.createElement(o.Z.Item,{key:e.code},e.name)))))),n.createElement(c.Z.Content,{style:{background:"#fff"}},n.createElement(v.Z,null,n.createElement(s.Z,{form:x,layout:"inline"},n.createElement(s.Z.Item,{name:"name"},n.createElement(d.Z.Search,{placeholder:"名字",onSearch:z})),n.createElement(s.Z.Item,{name:"status"},n.createElement(u.Z,{placeholder:"用户状态",style:{width:"140px"},allowClear:!0,onChange:z},n.createElement(u.Z.Option,{value:"0"},"暂停"),n.createElement(u.Z.Option,{value:"1"},"启用")))),n.createElement("div",null,n.createElement(O.Z,{name:k.g3.SYSTEM_DICT_ADD},n.createElement(r.Z,{type:"primary",onClick:()=>B()},"新增")),"  ",n.createElement(r.Z,{onClick:Y},"刷新"))),n.createElement("div",{style:{background:"#fff"}},n.createElement(m.Z,Object.assign({expandable:{defaultExpandAllRows:!0},columns:R,rowKey:"id"},V))))),n.createElement(f.default,{visible:e,data:D,updateData:F,setVisible:t}),n.createElement(E.default,{parentId:P,isTree:!!(null==D?void 0:D.is_tree),visible:a,data:C,type:_,setVisible:g,onOK:(e,t)=>{"update"===e?N(t.id,t):M(t)}}))}}}]);