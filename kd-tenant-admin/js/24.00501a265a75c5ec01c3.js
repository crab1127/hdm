(window.webpackJsonp=window.webpackJsonp||[]).push([[24,69],{158:function(e,t,a){"use strict";a.r(t);var n=a(5),l=a(1),s=a.n(l),i=a(4),c=a(3),o=a(205),r=a(206),u=a(208),d=a(8),m=a(203),p=a.n(m),b=a(39),f=a(16);t.default=()=>{var e;const[t,a]=Object(l.useState)(1),[m]=i.Form.useForm(),g=Object(u.a)(!1),v=Object(c.useHistory)(),O=Object(c.useRouteMatch)(),h=Object(u.b)(()=>d.wb({cache:1}).then(e=>e.data));Object(l.useEffect)(()=>{"/shop/chaoshi"===O.path?a(4):a(1)},[]);const{tableProps:j,search:E,refresh:y,update:k,add:F}=Object(o.a)((e,t)=>("/shop/chaoshi"===O.path?d.B:d.zb)(Object.assign(Object.assign({},e),t)).then(e=>({total:e.total,list:e.data})),{defaultPageSize:20,form:m}),{type:I,changeType:w,submit:x}=E||{},C=[{title:"id",dataIndex:"id"},{title:"门店",dataIndex:"name"},{title:"封面",key:"logo",render:(e,t)=>s.a.createElement("img",{src:Object(f.b)(t.logo),width:"30"})},{title:"电话",dataIndex:"mobile"},{title:"分类",key:"waimai_category_id",render:(e,t)=>{var a,n;return s.a.createElement("div",null,(null===(n=null===(a=h.data)||void 0===a?void 0:a.find(e=>e.id===t.waimai_category_id))||void 0===n?void 0:n.name)||"--")}},{title:"地址",dataIndex:"address"},{title:"备注",dataIndex:"remark"},{title:"状态",key:"status",render:e=>s.a.createElement(i.Switch,{checked:!!e.status,onChange:t=>((e,t)=>{k(t.id,Object.assign(Object.assign({},t),{status:e?1:0})),d.rc(t.id,{status:e?1:0})})(t,e)})},{title:"创建时间",key:"create_time",render:e=>s.a.createElement("span",null," ",p()(e.create_time).format("YYYY-MM-DD"))},{title:"操作",key:"action",render:e=>s.a.createElement("div",null,s.a.createElement(i.Button,{onClick:()=>(e=>Object(n.a)(void 0,void 0,void 0,(function*(){console.log(O);const t="/shop/chaoshi"===O.path?`/shop/chaoshi/${e.id}`:`/shop/waimai/list/${e.id}`;v.push({pathname:t})})))(e),type:"link"},"详情"))}];return s.a.createElement("div",null,s.a.createElement(r.a,{space:!0,visible:"simple"!==I},s.a.createElement("div",{className:"flex"},s.a.createElement(i.Form,{form:m,layout:"inline"},s.a.createElement(i.Form.Item,{name:"name"},s.a.createElement(i.Input.Search,{placeholder:"名字",onSearch:x})),s.a.createElement(i.Form.Item,{name:"waimai_category_id"},s.a.createElement(i.Select,{placeholder:"状态",style:{width:"140px"},allowClear:!0,onChange:x},null===(e=h.data)||void 0===e?void 0:e.map(e=>s.a.createElement(i.Select.Option,{key:e.id,value:e.id},e.name)))),s.a.createElement(i.Form.Item,{name:"status"},s.a.createElement(i.Select,{placeholder:"状态",style:{width:"140px"},allowClear:!0,onChange:x},s.a.createElement(i.Select.Option,{value:"0"},"暂停"),s.a.createElement(i.Select.Option,{value:"1"},"启用")))),s.a.createElement(i.Button,{type:"link",onClick:w},"高级搜索")),s.a.createElement("div",null,s.a.createElement(i.Button,{type:"primary",onClick:()=>Object(n.a)(void 0,void 0,void 0,(function*(){g.setTrue()}))},"新增"),"  ",s.a.createElement(i.Button,{onClick:y},"刷新"))),s.a.createElement("div",{style:{background:"#fff"}},s.a.createElement(i.Table,Object.assign({},j,{columns:C,rowKey:"id"}))),s.a.createElement(b.default,{categoryId:t,visible:g.state,setVisible:g.toggle,onOk:e=>{F(e)}}))}},202:function(e,t,a){(t=a(15)(!1)).push([e.i,"/** @format */\n.toolsBar {\n  background: #fff;\n  padding-bottom: 15px;\n}\n.toolsBar.toolsBar_space {\n  padding: 12px;\n}\n.toolsBar .toolsBar-content {\n  padding: 10px;\n  background: #f4f4f4;\n  margin-top: 5px;\n}\n",""]),e.exports=t},203:function(e,t,a){e.exports=a(6)(3e3)},205:function(e,t,a){"use strict";var n=a(5),l=a(214),s=a(1);t.a=function(e,t){var a;const{form:i}=t,c=Object(n.b)(t,["form"]),o=Object(l.a)(e,Object.assign(Object.assign({},c),{paginated:!0,manual:!0})),{params:r,run:u,mutate:d}=o,m=r[2]||{},[p,b]=Object(s.useState)(m.type||"simple"),[f,g]=Object(s.useState)(m.allFormData||{}),v=Object(s.useCallback)(()=>{if(i.getFieldInstance){const e=i.getFieldsValue(),t={};return Object.keys(e).forEach(a=>{i.getFieldInstance&&!i.getFieldInstance(a)||(t[a]=e[a])}),t}return i.getFieldsValue(null,()=>!0)},[i]);Object(s.useEffect)(()=>{if(i.getFieldInstance){const e={};Object.keys(f).forEach(t=>{i.getFieldInstance&&!i.getFieldInstance(t)||(e[t]=f[t])}),i.setFieldsValue(e)}else i.setFieldsValue(f)},[p]),Object(s.useEffect)(()=>{r.length>0?u(...r):t.manual||h()},[]);const O=Object(s.useCallback)(()=>{const e=v();g(Object.assign(Object.assign({},f),e)),b("simple"===p?"advance":"simple")},[p,f,v]),h=Object(s.useCallback)(e=>{(null==e?void 0:e.preventDefault)&&e.preventDefault(),setTimeout(()=>{const e=v();console.log(1111,e);const t=Object.assign(Object.assign({},f),e);g(t),u(Object.assign(Object.assign({},r[0]||{}),{current:1}),e,{allFormData:t,type:p})})},[v,u,r,f,p]),j=Object(s.useCallback)(()=>{i.resetFields(),h()},[i,h]);return Object.assign(Object.assign({},o),{search:{submit:h,type:p,changeType:O,reset:j},remove:e=>{d(t=>{const a=t.list.slice();return a.forEach((t,n)=>{t.id===e&&a.splice(n,1)}),Object.assign(Object.assign({},t),{list:a})})},add:e=>{d(t=>{const a=t.list.slice();return a.push(e),Object.assign(Object.assign({},t),{list:a})})},update:(e,t)=>{d(a=>{const n=a.list.slice();return n.forEach((a,l)=>{a.id===e&&(n[l]=Object.assign(Object.assign({},a),t))}),Object.assign(Object.assign({},a),{list:n})})},dataSource:(null===(a=o.data)||void 0===a?void 0:a.list)||[]})}},206:function(e,t,a){"use strict";var n=a(1),l=a.n(n),s=a(21),i=a.n(s);a(207);const c=({visible:e,content:t,space:a,children:n})=>l.a.createElement("div",{className:i()({toolsBar_space:a},"toolsBar")},l.a.createElement("div",{className:"flex flex_between"},n),l.a.createElement("div",{style:{display:e?"block":"none"},className:"toolsBar-content"},t));c.defaultProps={visible:!1,space:!1},t.a=c},207:function(e,t,a){var n=a(14),l=a(202);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);var s={insert:"head",singleton:!1},i=n(l,s);if(!l.locals||e.hot.invalidate){var c=l.locals;e.hot.accept(202,(function(){"string"==typeof(l=(l=a(202)).__esModule?l.default:l)&&(l=[[e.i,l,""]]),function(e,t){if(!e&&t||e&&!t)return!1;var a;for(a in e)if(e[a]!==t[a])return!1;for(a in t)if(!e[a])return!1;return!0}(c,l.locals)?(c=l.locals,i(l)):e.hot.invalidate()}))}e.hot.dispose((function(){i()})),e.exports=l.locals||{}},209:function(e,t,a){e.exports=a(6)(408)},210:function(e,t,a){e.exports=a(6)(2717)},211:function(e,t,a){e.exports=a(6)(75)},213:function(e,t,a){"use strict";var n=a(1),l=a.n(n),s=a(4),i=a(210),c=a(8);function o(e){const t="image/jpeg"===e.type||"image/png"===e.type;t||s.message.error("You can only upload JPG/PNG file!");const a=e.size/1024/1024<.5;return a||s.message.error("Image must smaller than 500Kb!"),t&&a}t.a=e=>{const[t,a]=Object(n.useState)(!1),[r,u]=Object(n.useState)(""),[d,m]=Object(n.useState)("");Object(n.useEffect)(()=>{Object(c.nb)().then(e=>{m(e.data)})},[]),Object(n.useEffect)(()=>{u(e.value?e.value:"")},[e.value]);const p=l.a.createElement("div",null,t?l.a.createElement(i.LoadingOutlined,null):l.a.createElement(i.PlusOutlined,null),l.a.createElement("div",{className:"ant-upload-text"},"Upload"));return l.a.createElement(s.Upload,{name:"file",data:()=>({token:d}),listType:"picture-card",className:"avatar-uploader",showUploadList:!1,action:"https://up-z2.qiniup.com",beforeUpload:o,onChange:t=>{var n;if("uploading"!==t.file.status){if("done"===t.file.status){console.log(t.fileList[0].response.data);const l="http://static.kuaidaxy.com/"+t.fileList.pop().response.key;null===(n=e.onChange)||void 0===n||n.call(e,l.replace("https://","")),function(e,t){const a=new FileReader;a.addEventListener("load",()=>t(a.result)),a.readAsDataURL(e)}(t.file.originFileObj,e=>{a(!1),u(e)})}}else a(!0)}},r?l.a.createElement("img",{src:r,alt:"avatar",style:{width:"100%"}}):p)}},39:function(e,t,a){"use strict";a.r(t);var n=a(5),l=a(1),s=a.n(l),i=a(4),c=a(8),o=a(213);const r={labelCol:{span:4},wrapperCol:{span:20}};t.default=e=>{var t=Object(n.b)(e,[]);const[a]=i.Form.useForm();Object(l.useEffect)(()=>{t.visible&&setTimeout(()=>{a.setFieldsValue({status:1,sort:1})},100)},[t.visible]);return s.a.createElement(i.Modal,{title:"添加",maskClosable:!1,visible:t.visible,onCancel:()=>t.setVisible(),onOk:e=>{e.preventDefault(),a.validateFields().then(e=>Object(n.a)(void 0,void 0,void 0,(function*(){var a;const n=yield c.t(Object.assign(Object.assign({},e),{category_id:t.categoryId}));t.setVisible(),null===(a=t.onOk)||void 0===a||a.call(t,Object.assign({id:n.data},e))})))}},s.a.createElement(i.Form,Object.assign({form:a},r),s.a.createElement(i.Form.Item,{label:"商店名字",name:"name",rules:[{required:!0}]},s.a.createElement(i.Input,null)),s.a.createElement(i.Form.Item,{label:"联系人",name:"contacts",rules:[{required:!0}]},s.a.createElement(i.Input,null)),s.a.createElement(i.Form.Item,{label:"联系电话",name:"mobile",rules:[{required:!0}]},s.a.createElement(i.Input,null)),s.a.createElement(i.Form.Item,{getValueFromEvent:e=>e,extra:"建议尺寸200 * 200",label:"logo",name:"logo",rules:[{required:!0}]},s.a.createElement(o.a,null))))}}}]);